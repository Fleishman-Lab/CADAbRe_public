<ROSETTASCRIPTS>

  <SCOREFXNS>
    <ScoreFunction name="H_bond">
      <Reweight scoretype="hbond_sr_bb" weight="1.0"/>
      <Reweight scoretype="hbond_lr_bb" weight="1.0"/>
      <Reweight scoretype="hbond_bb_sc" weight="1.0"/>
      <Reweight scoretype="hbond_sc" weight="1.0"/>
    </ScoreFunction>

    <ScoreFunction name="ref_full" weights="ref2015">
      <Reweight scoretype="coordinate_constraint" weight="0.6"/>
      <Reweight scoretype="res_type_constraint" weight="0.4"/>
    </ScoreFunction>

  </SCOREFXNS>

  <TASKOPERATIONS>
    <InitializeFromCommandline name="init"/>
    <DesignAround name="des_around" design_shell="0.1" resnums="%%current_res%%" repack_shell="8.0"/>
    <ReadResfile name="allowed_aas" filename="%%input_resfile%%" />
  </TASKOPERATIONS>

  <MOVERS>
    <AtomTree name="tree" docking_ft="1"/>
    <TaskAwareCsts name="add_CA_cst" anchor_resnum="1"/>
    <MinMover name="min_all" scorefxn="ref_full" chi="1" bb="1" jump="1"/>
  </MOVERS>

  <FILTERS>
    <ScoreType name="stability_score_full" scorefxn="H_bond" score_type="total_score" threshold="0.0"/>
    <Delta name="delta_score_full" filter="stability_score_full" upper="1" lower="0" range="0.5"/>
    <Time name="timer"/>
    <FilterScan name="filter_scan" scorefxn="H_bond" keep_native="1" task_operations="init,des_around,allowed_aas" delta_filters="delta_score_full" delta="true" resfile_name="%%path%%/res_%%current_res%%.resfile" report_all="1" score_log_file="%%path%%/res_%%current_res%%_score_full.log"/>
  </FILTERS>

  <PROTOCOLS>
    <Add filter="timer"/>
    <Add mover_name="tree"/>
    <Add mover_name="add_CA_cst"/>
    <Add filter="filter_scan"/>
    <Add filter="timer"/>
  </PROTOCOLS>

</ROSETTASCRIPTS>